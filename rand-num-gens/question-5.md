# Вопрос №5. Критерий серий для проверки равномерности пар генерируемых случайных чисел

1. Выбирается число $d$ (обычно степень двойки).
2. [Генерируется](./question-1.md) последовательность случайных чисел
   $U_1, U_2, \ldots, U_{2n}$, равномерно распределённых в интервале
   $\left[0, \, 1\right)$.
3. Из них получают целочисленные случайные величины $Y_1, Y_2, \ldots, Y_{2n}$
   ($Y_i = \left\lfloor d \cdot U_i \right\rfloor$).
4. Для проверки равномерности пар рассматривают
   $\left(Y_1, Y_2\right), \left(Y_3, Y_4\right), \ldots, \left(Y_{2n -1}, Y_{2n}\right)$.
5. Если $f_{ij}$ — абсолютная частота в этой последовательности пары
   $\left(i, j\right)$, а каждый индекс принимает значения от $0$ до $d-1$, то
   используя «Хи-квадрат» критерий Пирсона
   $\chi^2 = \sum\limits_{i, \,j = 0}^{d-1} \dfrac{\left(f_{ij} - n \cdot p_{ij}\right)^2}{n \cdot p_{ij}} = \dfrac{d^2}{n} \cdot \sum\limits_{i, \,j = 0}^{d-1} f_{ij}^2 - n$,
   имеющий $\left(d^2 - 1\right)$ степеней свободы, можно, сравнивая с табличным
   значением критерия, установить равномерность получаемых последовательностей
   пар.

   > Теоретическая вероятность появления пары $\left(i, j\right)$ —
   > $p_{ij} = \dfrac{1}{d^2}$.

> [!NOTE] Примечание
>
> Аналогичные проверки можно применять для подряд идущих троек, четвёрок и т.д.
>
> Генерировать приходится, соответственно, $3n$, $4n$ и т.д. равномерно
> распределённых в интервале $\left[0, \, 1\right)$ случайных чисел.
>
> При этом в критерии в вычислениях $d^2$ везде заменяется, соответственно, на
> $d^3$, $d^4$ и т.д.
