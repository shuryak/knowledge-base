# Вопрос №7. Критерий интервалов

> Основу этой проверки составляет закон геометрического распределения
> вероятностей.
>
> В общем случае он заключается в проведении испытаний по схеме Бернулли
> относительно некоторого события $A$, вероятность появления которого в каждом
> опыте — $\mathrm{P}\left(A\right) = p$, а
> $\mathrm{P}\left(\bar{A}\right) = q = 1-p$.
>
> Дискретная случайная величина $X$ — число испытаний до первого появления
> события $A$ (точнее, количество «неуспешных» испытаний по отношению появления
> события $A$, подчинена геометрическому распределению).
>
> При этом $X$ может принимать любые целые неотрицательные значения с
> вероятностью <mark>$\mathrm{P}\left(X = r\right) = q^r \cdot p$, где
> $r \in \mathbb{Z}^+$</mark>.

Для оценки качества генерируемых последовательностей событие $A$ обозначает
«попадание сгенерированного числа в интервал $\left[\alpha, \, \beta\right]$».
Интервал находится внутри единичного отрезка. Вероятность попадания числа из
$\left[0, \, 1\right)$ в $\left[\alpha, \, \beta\right]$ равна $\beta - \alpha$.

Алгоритм проверки:

1. Выбираются натуральные числа $d$ и $t$.
2. В сгенерированной последовательности $U_1, U_2, \ldots, U_n$ для каждого
   $r = 0, 1, \ldots, t-1$ подсчитывается количество подпоследовательностей
   $f_r$, содержащих ровно $r$ чисел, не попавших в интервал
   $\left[\alpha, \, \beta\right]$, а также количество таких же
   подпоследовательностей, имеющих длину больше или равную $t$.
3. Вероятность $p_r$ для значений $r = 0, 1, \ldots, t-1$ находится из
   <mark>формулы</mark>, а $p_t = \mathrm{P}\left(X \geqslant t\right) = q^t$.

   > Последнее выражение получаем, применяя формулу суммы геометрической
   > прогрессии, из соотношений:
   > $\mathrm{P}\left(X \geqslant t\right) = 1 - \sum\limits_{r=0}^{t-1} \mathrm{P}\left(X = r\right) = 1 - \sum\limits_{r=0}^{t-1}q^r \cdot p = 1 - p \cdot \dfrac{1-q^t}{1-q} = q^t$.

   > [!NOTE] Примечание
   >
   > Выбирая числа $d$, $t$ и $n$, учитывают выполнение соотношения
   > $d \cdot p_r \geqslant 5$. При этом количество сгенерированных чисел $n$
   > должно быть таким, чтобы количество всех подпоследовательностей равнялось
   > $d$, т.е. $\sum\limits_{r=0}^{t} f_r = d$.

4. Проверяется гипотеза о соответствии закона распределения таких
   подпоследовательностей геометрическому закону. Например, используя критерий
   Пирсона с $t$ степенями свободы
   $\chi^2 = \sum\limits_{r=0}^{t} \dfrac{\left(f_r - d \cdot p_r\right)^2}{d \cdot p_r}$.

> Предлагаемые варианты выбора интервала $\left[\alpha, \, \beta\right]$:
> $\left[0, 0.5\right]$, $\left[0.5, 1\right]$,
> $\left[\dfrac{1}{3}, \, \dfrac{2}{3}\right]$. Для первых двух
> $\mathrm{P}\left(A\right) = p = \dfrac{1}{2}$, для третьего —
> $p = \dfrac{1}{3}$.

<!-- TODO: предлагаемые для чего? -->
