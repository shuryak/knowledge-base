# Вопрос №4. Критерий Пирсона для проверки генератора случайных чисел

> Так как большинство генераторов случайных чисел являются программно
> реализованными, то получаемые случайные последовательности детерминированные,
> а следовательно, являются зависимыми.

Критерий согласия Пирсона в общем случае используется для проверки нулевой
гипотезы — $H_0: F\left(x\right) = F_0\left(x\right)$, и альтернативной —
$H_1: F\left(x\right) \neq F_0\left(x\right)$.

С помощью этого критерия проверяется согласие выборочных данных гипотетическому
предположению относительно теоретической функции распределения вероятности
$F_0\left(x\right)$.

В нашем случае проверяется близость закона распределения вероятностей
генерируемых последовательностей равномерному закону распределения.

Алгоритм проверки:

1. Выбирается число $d$ (обычно степень двойки).
2. Из последовательности чисел $U_1, U_2, \ldots, U_n$, распределённых в
   интервале $\left[0, 1\right)$, получают целочисленные случайные величины
   $Y_1, Y_2, \ldots, Y_n$ ($Y_i = \left\lfloor d \cdot U_i \right\rfloor$).
   Значения $Y_i$ изменяются от $0$ до $d-1$.

Для равномерного закона распределения каждое из них должно появляться с
вероятностью $\mathrm{P}\left(Y_i = r\right) = p_r = \dfrac{1}{d}$, где
$r \in \overline {0\,..\,d - 1}$. Обозначим частоту появления в
последовательности $Y_1, Y_2, \ldots, Y_n$ значения $r$ через $f_r$, и
используем критерий Пирсона для проверки гипотезы о равномерности генеральной
совокупности $\left\{Y_i\right\}$:

$$
\chi^2 =
\sum\limits_{r=0}^{d-1} \dfrac{\left(f_r - n \cdot p_r\right)^2}{n \cdot p_r} =
\sum\limits_{r=0}^{d-1} \dfrac{\left(f_r - \dfrac{n}{d}\right)^2}{\dfrac{n}{d}} =
\frac{d}{n} \cdot \sum\limits_{r=0}^{d-1} \left(f_r^2 - 2 \cdot f_r \cdot \dfrac{n}{d} +
\left(\dfrac{n}{d}\right)^2\right) =
$$

$$
= \frac{d}{n} \left(\sum\limits_{r=0}^{d-1} f_r^2 - 2 \cdot \dfrac{n}{d} \cdot
\sum\limits_{r=0}^{d-1} f_r + \sum\limits_{r=0}^{d-1} \left(\dfrac{n}{d}\right)^2\right) =
\frac{d}{n} \left(\sum\limits_{r=0}^{d-1} f_r^2 - 2 \cdot \dfrac{n}{d} \cdot n +
d \cdot \left(\dfrac{n}{d}\right)^2\right) =
$$

$$
= \frac{d}{n} \left(\sum\limits_{r=0}^{d-1} f_r^2 - \dfrac{n^2}{d}\right) =
\frac{d}{n} \cdot \sum\limits_{r=0}^{d-1} f_r^2 - n
$$

> [!NOTE] Примечание
>
> В преобразованиях использовано равенство $\sum\limits_{r=0}^{d-1} f_r = n$,
> так как сумма всех частот равна количеству сгенерированных чисел.

Критерий согласия Пирсона подчиняется асимптотическому «Хи-квадрат»
распределению с $d-1$ степенями свободы.

Чтобы закон распределения вероятностей указанного критерия был близок к закону
распределения «Хи-квадрат», должно выполняться соотношение
$n \cdot p_r \geqslant 5$. Выбирать $d$ и $n$ нужно учитывая неравенство
$n \geqslant 5 \cdot d$.

Сравнивая $\chi^2$ с табличным значением критерия $\chi_{\alpha, \,d-1}^2$ для
заданного уровня значимости $\alpha$ (например, $0.05$ или $0.01$), можно
установить равномерность получаемых последовательностей. Если
$\chi^2 < \chi_{\alpha, \,d-1}^2$, то генерируемые последовательности можно
считать выбранными из равномерно распределённой генеральной совокупности.

> Одним из основных недостатков «Хи-квадрат» — критерия Пирсона является
> отсутствие чёткого правила выбора интервалов. Иногда на практике для одного и
> того же набора проверяемой выборочной совокупности в зависимости от способа
> выбора интервалов можно получить диаметрально противоположные выводы
> относительно закона распределения в генеральной совокупности.
